# lisp语法

> lisp是一大堆语言，所学的版本是MIT Scheme，大概是R5R5规范

## 0.介绍和组合式

- 基本写法```(+ 1 2)```前缀表达式
- 表达式的范围使用小括号界定，总使用前缀表达式，可以嵌套很多层，因为对空格不敏感，所以可以写成美观的形式
- 可以支持多个实参的运算，减法和出发运行只带一个实参
- 在观察lisp语言时，可以先看**最里面的括号**，可以更快理清思路

## 1.特殊形式

> 特殊形式并非组合式/过程调用

- 组合式的计算方法：对运算符求值，找到对应过程，然后按顺序对每一个参数求值，直到运算对象是平凡的，最后将平凡的运算对象绑定在函数的形参中，计算结果*其实就是传参的意思*
- **比较大小**的运算符是正常的组合式形式，返回的真值是#t
- **命名**：```(define (func x) (* x x))```函数命名，变量命名同理
- ```if```：惰性求值

## 2.列表

- **创建**：```(list 1 2 34)```
- **访问**：使用car得首元素，cdr得除去首元素之外的新表(并不是直接移除)
- 空表是特殊值，无法被car/cdr作用
- 内置过程```equal?```，比较两个操作元素是否相等
- 使用递归来表达循环

## 3.映射

- **基本形式**：```(map func list)```  
- 会得到一个新列表，每个元素是原来的元素经过函数处理之后的结果
- **特殊形式lambda**：可以用来定义局部变量或者匿名过程```(lambda(x)(* x 2))```
- let特殊形式定义**局部变量**，可以减少所需的计算
- define不能出现在if里面，而let可以在任何位置都运行出现

## 4.对子

> 它是lisp中唯一的复合数据类型，可以嵌套，可以构成列表和更复杂的数据结构，也是源码的结果(少了个单引号)

- **基本形式**：```(cons 1 2)```
- **符号**：是一种表示变量名的字符串单引号加变量名就是符号
- ```quote```是一个特殊形式，它阻止其参数被求值。对于教程最后的思考题，'(quote x)实际上是一个包含两个元素quote和x的列表，而不是一个待求值的表达式。
- 自求值类型的求值就是自身，被quote作用后不会加'

> 这个案例我们可以一窥 Lisp 解释器的构造。假设 Lisp 解释器正在解释一个列表形式的源码。如果列表的 car 是一个符号，而且符号名指代了特殊形式如 'define，那么执行相关的特殊逻辑。否则，对列表中的每一个元素进行求值。

> - 对整数、布尔类型的求值结果仍然是它自身——这种元素类型称为自求值类型。
> - 对符号类型的求值结果，就是查找当前环境定义的所有变量名，找到这个符号名对应的值作为求值结果。
> - 对列表类型求值，就是调用过程的逻辑了。将列表的 car 部分作为要调用的过程，将 cdr 部分作为实参，然后绑定到对应形参，执行过程的定义。


